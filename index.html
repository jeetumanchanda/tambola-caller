<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tambola Caller</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#071023">
<style>
:root{
  --bg:#071023;
  --panel:#071726;
  --accent:#ffb703;
  --cell:#0b2340;
  --white:#eaf3ff;
  --red:#dc2626;
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--white);-webkit-font-smoothing:antialiased}
.container{max-width:980px;margin:12px auto;padding:12px}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.title{font-weight:700;font-size:18px}
.board{display:grid;grid-template-columns:repeat(9,1fr);gap:8px;background:transparent;padding:6px;border-radius:10px}
.cell{position:relative;aspect-ratio:1/1;min-height:56px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));display:grid;place-items:center;border-radius:10px;font-weight:700;color:var(--white);border:1px solid rgba(255,255,255,0.03);user-select:none;transition:transform .12s,box-shadow .12s}
.cell:hover{transform:translateY(-6px);box-shadow:0 8px 30px rgba(0,0,0,0.45)}
.cell[data-col="1"]{background:linear-gradient(180deg,#2a3d6b22,#10223a22)}
.cell[data-col="2"]{background:linear-gradient(180deg,#3b5a3b22,#0b2b1a22)}
.cell[data-col="3"]{background:linear-gradient(180deg,#4b2a5f22,#200b2b22)}
.cell[data-col="4"]{background:linear-gradient(180deg,#5a3d2a22,#2b170b22)}
.cell[data-col="5"]{background:linear-gradient(180deg,#2a5a5a22,#07272722)}
.cell[data-col="6"]{background:linear-gradient(180deg,#3b3b5a22,#0b0b2b22)}
.cell[data-col="7"]{background:linear-gradient(180deg,#5a2a2a22,#2b0b0b22)}
.cell[data-col="8"]{background:linear-gradient(180deg,#2a2a5a22,#0b0b2b22)}
.cell[data-col="9"]{background:linear-gradient(180deg,#3a2a5a22,#120b2b22)}

/* called style - red ring */
.cell.called::after{
  content:"";
  position:absolute;inset:8px;border-radius:50%;border:6px solid rgba(220,38,38,0.98);
  box-shadow:0 10px 30px rgba(220,38,38,0.12), 0 0 18px rgba(255,80,80,0.06);
  pointer-events:none;
}

/* controls */
.controls{display:flex;gap:12px;align-items:center;margin-top:12px;justify-content:center}
.bell{width:72px;height:72px;border-radius:14px;display:grid;place-items:center;background:linear-gradient(180deg,#ffd27f,#ffb703);box-shadow:0 8px 30px rgba(0,0,0,0.35);border:none;cursor:pointer;transition:transform .12s}
.bell:active{transform:translateY(2px) scale(.99)}
.reset{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--white);padding:10px 12px;border-radius:10px;cursor:pointer}
.stats{color:rgba(234,243,255,0.9);font-size:14px;text-align:center}

/* overlay */
.overlay{position:fixed;inset:0;display:grid;place-items:center;background:rgba(2,6,23,0.6);backdrop-filter:blur(6px);z-index:60;opacity:0;pointer-events:none;transition:opacity .18s}
.overlay.show{opacity:1;pointer-events:auto}
.bignum{
  width:320px;height:320px;border-radius:50%;display:grid;place-items:center;
  background:radial-gradient(circle at 30% 20%, rgba(255,255,255,0.06), rgba(0,0,0,0.2)), linear-gradient(180deg,#ffd27f,#ffb703);
  box-shadow: 0 30px 90px rgba(0,0,0,0.6), 0 0 60px rgba(255,183,3,0.12);
  font-size:140px;font-weight:900;color:#2b1000;transform:scale(.6);animation:pop .5s cubic-bezier(.2,.9,.22,1);
  position:relative; overflow:visible;
}
@keyframes pop{from{transform:scale(.35) rotate(-8deg)} to{transform:scale(1) rotate(0)}}

/* neon pulse behind the number */
.bignum::before{
  content:"";position:absolute;inset:-20px;border-radius:50%;background:radial-gradient(circle, rgba(255,80,80,0.18), rgba(220,38,38,0.06));filter:blur(18px);opacity:0.95;animation:pulse 1.6s infinite;
}
@keyframes pulse{0%{transform:scale(.9);opacity:.8}50%{transform:scale(1.06);opacity:1}100%{transform:scale(.9);opacity:.8}}

/* confetti shards */
.confetti{
  pointer-events:none;position:absolute;width:8px;height:16px;background:linear-gradient(180deg,#fff6b3,#ffd27f);opacity:0;transform:translateY(-40px) rotate(10deg);
  animation:confetti-fall 1.4s forwards;
}
@keyframes confetti-fall{
  0%{opacity:1;transform:translateY(-20px) rotate(0) scale(1)}
  100%{opacity:0;transform:translateY(200px) rotate(320deg) scale(.6)}
}

/* footer */
.footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;font-size:13px;color:rgba(234,243,255,0.7)}

@media (max-width:720px){
  .bignum{width:220px;height:220px;font-size:96px}
  .cell{min-height:44px}
  .board{gap:6px}
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Tambola caller">
  <div class="header"><div class="title">Tambola Caller — 1 to 90</div></div>

  <main>
    <div id="board" class="board" role="grid" aria-label="Tambola board"></div>

    <div class="controls">
      <button id="bell" class="bell" aria-label="Call next number" title="Call next number" >
        <svg viewBox="0 0 24 24" width="36" height="36" fill="none" aria-hidden="true">
          <path d="M12 2C10.3431 2 9 3.34315 9 5V6.089C6.16344 7.0812 4 9.88051 4 13V17L2 19V20H22V19L20 17V13C20 9.88051 17.8366 7.0812 15 6.089V5C15 3.34315 13.6569 2 12 2Z" fill="#fff"/>
        </svg>
      </button>

      <button id="reset" class="reset" title="Reset session">Reset</button>

      <div style="display:flex;flex-direction:column;align-items:flex-start;">
        <div class="stats">Last call: <strong id="last">—</strong></div>
        <div class="stats">Calls made: <strong id="count">0</strong>/90</div>
      </div>
    </div>

    <div class="footer">
      <div>Tip: Press <strong>Space</strong> to call</div>
      <div>APP-BY-JEET</div>
    </div>
  </main>
</div>

<div id="overlay" class="overlay" aria-hidden="true">
  <div class="bignum" id="bignum">0</div>
</div>

<script>
(function(){
  const board = document.getElementById('board');
  const bell = document.getElementById('bell');
  const resetBtn = document.getElementById('reset');
  const lastEl = document.getElementById('last');
  const countEl = document.getElementById('count');
  const overlay = document.getElementById('overlay');
  const bignum = document.getElementById('bignum');

  // create 1..90 cells in 9 columns
  for(let i=1;i<=90;i++){
    const col = ((i-1)%9)+1;
    const cell = document.createElement('div');
    cell.className = 'cell';
    cell.setAttribute('data-col', col);
    cell.setAttribute('data-num', i);
    cell.setAttribute('role','gridcell');
    cell.innerHTML = '<span>'+i+'</span>';
    board.appendChild(cell);
  }

  let called = new Set();
  let available = Array.from({length:90}, (_,i)=>i+1);

  function pickRandom(){
    if(available.length===0) return null;
    const idx = Math.floor(Math.random()*available.length);
    const num = available.splice(idx,1)[0];
    called.add(num);
    return num;
  }

  function markNumber(num){
    const sel = board.querySelector('.cell[data-num=\"'+num+'\"]');
    if(sel) sel.classList.add('called');
  }

  function spawnConfetti(count){
    for(let i=0;i<count;i++){
      const c = document.createElement('div');
      c.className='confetti';
      c.style.left = (50 + (Math.random()*40-20)) + '%';
      c.style.top = (50 + (Math.random()*20-10)) + '%';
      c.style.background = ['#ff6b6b','#ffd93d','#6bffb3','#6bd3ff'][Math.floor(Math.random()*4)];
      c.style.transform = 'translate(-50%,-50%) rotate('+ (Math.random()*360) +'deg)';
      overlay.appendChild(c);
      setTimeout(()=>c.remove(),1400);
    }
  }

  function showOverlay(num){
    bignum.textContent = num;
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');
    spawnConfetti(24);
    setTimeout(()=>{
      overlay.classList.remove('show');
      overlay.setAttribute('aria-hidden','true');
    },5200);
  }

  function updateStatus(num){
    countEl.textContent = called.size;
    lastEl.textContent = num? num : '—';
    if(available.length===0){
      bell.disabled = true;
      bell.style.opacity = '0.45';
    }
  }

  function callNext(){
    if(available.length===0) return;
    const n = pickRandom();
    if(n===null) return;
    markNumber(n);
    showOverlay(n);
    updateStatus(n);
  }

  bell.addEventListener('click', callNext);
  resetBtn.addEventListener('click', ()=>{
    called.clear();
    available = Array.from({length:90}, (_,i)=>i+1);
    board.querySelectorAll('.cell.called').forEach(c=>c.classList.remove('called'));
    updateStatus(null);
    bell.disabled = false;
    bell.style.opacity = '1';
  });

  document.addEventListener('keydown', (e)=>{
    if(e.code==='Space' && !e.repeat){
      e.preventDefault();
      if(!bell.disabled) callNext();
    }
  });

  overlay.addEventListener('click', ()=>{
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
  });

  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js').catch(()=>{});
  }

  // initial status
  updateStatus(null);
})();</script>
</body>
</html>
